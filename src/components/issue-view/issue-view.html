<!-- Issue View -->
<div *ngIf="isModalOpen" class="modal is-active">
  <div class="modal-background" (click)="handleClose()"></div>
  <div class="modal-card">
    <!-- Modal header -->
    <header class="modal-card-head">
      <p class="modal-card-title">{{ issue?.title }}</p>
      <button type="button" class="delete" aria-label="close" (click)="handleClose()"></button>
    </header>

    <!-- Modal body -->
    <section class="modal-card-body">
      <!-- Issue Meta Info -->
      <div class="columns is-multiline mb-5">
        <div class="column is-half">
          <label class="label">Assignee</label>
          <p class="has-text-weight-medium">{{ issue?.assignee }}</p>
        </div>
        <div class="column is-half">
          <label class="label">Priority</label>
          <span class="tag is-warning">{{ issue?.priority }}</span>
        </div>
        <div class="column is-half">
          <label class="label">Status</label>
          <span class="tag is-success">{{ issue?.status }}</span>
        </div>
        <div class="column is-half">
          <label class="label">Due Date</label>
          <p>{{ issue?.dueDate | date }}</p>
        </div>
        <div class="column is-half">
          <label class="label">Sprint</label>
          <p>{{ issue?.sprint }}</p>
        </div>
        <div class="column is-half">
          <label class="label">Story Points</label>
          <p>{{ issue?.storyPoints }}</p>
        </div>
      </div>

      <!-- Description -->
      <div class="mb-5">
        <label class="label">Description</label>
        <p>{{ issue?.description }}</p>
      </div>

      <!-- Subtasks -->
      <div class="mb-5">
        <label class="label">Subtasks</label>
        <ul>
          <li
            *ngFor="let sub of issue?.subtasks"
            class="box is-flex is-justify-content-space-between is-align-items-center"
          >
            <span>{{ sub.title }}</span>
            <span
              class="tag"
              [ngClass]="{
                'is-success': sub.status === 'Done',
                'is-info': sub.status === 'In Progress',
                'is-light': sub.status === 'To Do'
              }"
              >{{ sub.status }}</span
            >
          </li>
        </ul>
      </div>

      <!-- Connected Work Items -->
      <div class="mb-5">
        <label class="label">Connected Work Items</label>
        <ul>
          <li
            *ngFor="let work of issue?.connectedItems"
            class="box is-flex is-justify-content-space-between is-align-items-center"
          >
            <span class="has-text-weight-semibold">{{ work.key }}</span>
            <span class="is-size-7 has-text-grey">{{ work.type }}</span>
          </li>
        </ul>
      </div>

      <!-- Activity / Comments -->
      <div class="mb-5">
        <label class="label">Activity</label>
        <div>
          <div *ngFor="let c of issue?.comments" class="box">
            <p class="is-size-7">
              <b>{{ c.author }}:</b> {{ c.text }}
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer actions -->
    <footer class="modal-card-foot is-justify-content-flex-end">
      <button type="button" class="button is-link mr-4" (click)="onEdit()">Edit</button>
      <button type="button" class="button is-danger is-outlined" (click)="onDelete()">
        Delete
      </button>
    </footer>
  </div>
</div>
